# æ™ºèƒ½å®¶å±…å¤©æ°”çª—å¸˜è‡ªåŠ¨è°ƒèŠ‚ç³»ç»Ÿ

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºå¤©æ°”æ•°æ®çš„æ™ºèƒ½çª—å¸˜è‡ªåŠ¨è°ƒèŠ‚ç³»ç»Ÿï¼Œèƒ½å¤Ÿæ ¹æ®å®æ—¶å¤©æ°”æ¡ä»¶ï¼ˆå¦‚é˜³å…‰å¼ºåº¦ã€æ¸©åº¦ã€é™é›¨ç­‰ï¼‰è‡ªåŠ¨è°ƒæ•´çª—å¸˜çš„å¼€åˆç¨‹åº¦ï¼Œä¸ºæ‚¨çš„æ™ºèƒ½å®¶å±…æä¾›æ›´èˆ’é€‚å’ŒèŠ‚èƒ½çš„ç¯å¢ƒæ§åˆ¶ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸŒ¤ï¸ å¤©æ°”æ„ŸçŸ¥
- é›†æˆOpenWeatherMap APIè·å–å®æ—¶å¤©æ°”æ•°æ®
- æ”¯æŒå¤šç§å¤©æ°”æ¡ä»¶è¯†åˆ«ï¼šæ™´å¤©ã€é˜´å¤©ã€é›¨å¤©ã€æš´é£é›¨ã€é›¾å¤©ç­‰
- ç›‘æ§æ¸©åº¦ã€æ¹¿åº¦ã€UVæŒ‡æ•°ã€é£é€Ÿç­‰å…³é”®æŒ‡æ ‡

### ğŸ  æ™ºèƒ½æ§åˆ¶
- æ”¯æŒå¤šä¸ªçª—å¸˜è®¾å¤‡åŒæ—¶æ§åˆ¶
- åŸºäºè§„åˆ™çš„è‡ªåŠ¨åŒ–å†³ç­–ç³»ç»Ÿ
- å¯é…ç½®çš„çª—å¸˜ä½ç½®ï¼šå®Œå…¨å¼€å¯ã€å¤§éƒ¨åˆ†å¼€å¯ã€åŠå¼€ã€å¤§éƒ¨åˆ†å…³é—­ã€å®Œå…¨å…³é—­

### âš™ï¸ çµæ´»é…ç½®
- JSONé…ç½®æ–‡ä»¶æ”¯æŒ
- è‡ªå®šä¹‰å¤©æ°”è§„åˆ™å’Œä¼˜å…ˆçº§
- é™éŸ³æ—¶æ®µè®¾ç½®ï¼ˆé¿å…å¤œé—´è‡ªåŠ¨è°ƒèŠ‚ï¼‰
- æ‰‹åŠ¨è¦†ç›–åŠŸèƒ½

### ğŸ“Š ç›‘æ§ä¸æ—¥å¿—
- è¯¦ç»†çš„æ“ä½œæ—¥å¿—è®°å½•
- å¯é€‰çš„é€šçŸ¥åŠŸèƒ½ï¼ˆWebhookã€é‚®ä»¶ï¼‰
- å¼‚æ­¥å¤„ç†ç¡®ä¿ç³»ç»Ÿå“åº”æ€§èƒ½

## å®‰è£…è¦æ±‚

### Pythonä¾èµ–
```bash
pip install aiohttp requests
```

### ç³»ç»Ÿè¦æ±‚
- Python 3.7+
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºå¤©æ°”APIè°ƒç”¨ï¼‰
- æ™ºèƒ½çª—å¸˜è®¾å¤‡APIæ¥å£

## å¿«é€Ÿå¼€å§‹

### 1. è·å–å¤©æ°”APIå¯†é’¥
1. è®¿é—® [OpenWeatherMap](https://openweathermap.org/api)
2. æ³¨å†Œè´¦æˆ·å¹¶è·å–å…è´¹APIå¯†é’¥
3. å°†APIå¯†é’¥å¡«å…¥ `weather_config.json` æ–‡ä»¶

### 2. é…ç½®è®¾å¤‡ä¿¡æ¯
ç¼–è¾‘ `weather_config.json` æ–‡ä»¶ï¼š

```json
{
  "weather_api": {
    "api_key": "ä½ çš„OpenWeatherMap APIå¯†é’¥"
  },
  "location": {
    "city": "ä½ çš„åŸå¸‚åç§°",
    "country": "å›½å®¶ä»£ç "
  },
  "curtain_devices": [
    {
      "device_id": "curtain_living_room",
      "name": "å®¢å…çª—å¸˜",
      "api_endpoint": "ä½ çš„çª—å¸˜è®¾å¤‡APIåœ°å€",
      "room": "living_room",
      "enabled": true
    }
  ]
}
```

### 3. è¿è¡Œç³»ç»Ÿ
```python
import asyncio
from weather_module import WeatherCurtainAutomation

async def main():
    automation = WeatherCurtainAutomation(
        weather_api_key="ä½ çš„APIå¯†é’¥",
        curtain_device_id="curtain_living_room",
        location="Beijing"
    )
    
    # æ‰§è¡Œä¸€æ¬¡è°ƒèŠ‚
    await automation.update_curtain_based_on_weather()
    
    # æˆ–å¯åŠ¨æŒç»­ç›‘æ§
    await automation.start_monitoring(interval_minutes=30)

if __name__ == "__main__":
    asyncio.run(main())
```

## é…ç½®è¯¦è§£

### å¤©æ°”è§„åˆ™é…ç½®
ç³»ç»Ÿæ”¯æŒåŸºäºä»¥ä¸‹æ¡ä»¶çš„è‡ªå®šä¹‰è§„åˆ™ï¼š

- **å¤©æ°”æ¡ä»¶**: sunny, cloudy, rainy, snowy, stormy, foggy, windy
- **æ¸©åº¦èŒƒå›´**: æœ€ä½å’Œæœ€é«˜æ¸©åº¦é˜ˆå€¼
- **UVæŒ‡æ•°**: ç´«å¤–çº¿å¼ºåº¦é˜ˆå€¼
- **ç›®æ ‡ä½ç½®**: 0-100çš„çª—å¸˜å¼€åˆç™¾åˆ†æ¯”
- **ä¼˜å…ˆçº§**: æ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜

### ç¤ºä¾‹è§„åˆ™
```json
{
  "name": "å¼ºçƒˆé˜³å…‰é˜²æŠ¤",
  "condition": "sunny",
  "temperature_min": 25.0,
  "temperature_max": 40.0,
  "uv_threshold": 6.0,
  "target_position": 25,
  "priority": 1,
  "enabled": true
}
```

### é™éŸ³æ—¶æ®µ
é¿å…åœ¨ç¡çœ æ—¶é—´è‡ªåŠ¨è°ƒèŠ‚çª—å¸˜ï¼š
```json
{
  "quiet_hours": {
    "enabled": true,
    "start_time": "22:00",
    "end_time": "07:00"
  }
}
```

## APIæ¥å£

### WeatherCurtainAutomationç±»

#### ä¸»è¦æ–¹æ³•
- `update_curtain_based_on_weather()`: æ‰§è¡Œä¸€æ¬¡å¤©æ°”æ£€æŸ¥å’Œçª—å¸˜è°ƒèŠ‚
- `start_monitoring(interval_minutes)`: å¼€å§‹æŒç»­ç›‘æ§æ¨¡å¼
- `add_rule(rule)`: æ·»åŠ è‡ªå®šä¹‰æ§åˆ¶è§„åˆ™
- `remove_rule(condition, priority)`: ç§»é™¤æŒ‡å®šè§„åˆ™

#### ä½¿ç”¨ç¤ºä¾‹
```python
# åˆ›å»ºè‡ªå®šä¹‰è§„åˆ™
from weather_module import CurtainRule, WeatherCondition, CurtainPosition

custom_rule = CurtainRule(
    condition=WeatherCondition.WINDY,
    temperature_range=(10.0, 30.0),
    uv_threshold=0.0,
    target_position=CurtainPosition.MOSTLY_CLOSED,
    priority=2
)

automation.add_rule(custom_rule)
```

## è®¾å¤‡é›†æˆ

### çª—å¸˜è®¾å¤‡APIè¦æ±‚
ç³»ç»Ÿé€šè¿‡HTTP POSTè¯·æ±‚æ§åˆ¶çª—å¸˜è®¾å¤‡ï¼ŒæœŸæœ›çš„APIæ ¼å¼ï¼š

```json
POST /api/curtain
{
  "device_id": "curtain_001",
  "position": 75,
  "timestamp": "2025-01-08T10:30:00"
}
```

### æ”¯æŒçš„æ™ºèƒ½å®¶å±…å¹³å°
- Home Assistant
- OpenHAB
- è‡ªå®šä¹‰REST APIè®¾å¤‡
- MQTTè®¾å¤‡ï¼ˆéœ€è¦ç½‘å…³è½¬æ¢ï¼‰

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **APIå¯†é’¥é”™è¯¯**
   - æ£€æŸ¥OpenWeatherMap APIå¯†é’¥æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤APIå¯†é’¥æœ‰æ•ˆæœŸå’Œè°ƒç”¨é™åˆ¶

2. **çª—å¸˜è®¾å¤‡æ— å“åº”**
   - éªŒè¯è®¾å¤‡APIç«¯ç‚¹åœ°å€
   - æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œè®¾å¤‡çŠ¶æ€
   - æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

3. **å¤©æ°”æ•°æ®è·å–å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿æ¥
   - éªŒè¯åŸå¸‚åç§°æ‹¼å†™
   - ç¡®è®¤APIæœåŠ¡çŠ¶æ€

### æ—¥å¿—æŸ¥çœ‹
```bash
tail -f logs/weather_curtain.log
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥ä¿æŠ¤**: ä¸è¦å°†APIå¯†é’¥æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
2. **ç½‘ç»œå®‰å…¨**: ç¡®ä¿è®¾å¤‡APIä½¿ç”¨HTTPSè¿æ¥
3. **è®¿é—®æ§åˆ¶**: é™åˆ¶ç³»ç»Ÿçš„ç½‘ç»œè®¿é—®æƒé™
4. **å¤‡ä»½é…ç½®**: å®šæœŸå¤‡ä»½é…ç½®æ–‡ä»¶

## æ‰©å±•åŠŸèƒ½

### è®¡åˆ’ä¸­çš„åŠŸèƒ½
- [ ] æ”¯æŒæ›´å¤šå¤©æ°”APIæä¾›å•†
- [ ] æœºå™¨å­¦ä¹ ä¼˜åŒ–è°ƒèŠ‚ç­–ç•¥
- [ ] ç§»åŠ¨åº”ç”¨æ§åˆ¶ç•Œé¢
- [ ] ä¸å…¶ä»–æ™ºèƒ½å®¶å±…è®¾å¤‡è”åŠ¨
- [ ] èƒ½è€—ç»Ÿè®¡å’Œåˆ†æ

### è‡ªå®šä¹‰å¼€å‘
ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ”¯æŒä»¥ä¸‹æ‰©å±•ï¼š

1. **æ–°çš„å¤©æ°”æ•°æ®æº**: ç»§æ‰¿ `WeatherAPIClient` ç±»
2. **è®¾å¤‡æ§åˆ¶å™¨**: ç»§æ‰¿ `CurtainController` ç±»
3. **å†³ç­–è§„åˆ™**: æ‰©å±• `CurtainRule` æ•°æ®ç»“æ„

## è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

### å¼€å‘ç¯å¢ƒè®¾ç½®
```bash
git clone https://github.com/h66840/rag_project.git
cd rag_project
pip install -r requirements.txt
```

### ä»£ç è§„èŒƒ
- éµå¾ªPEP 8ç¼–ç è§„èŒƒ
- æ·»åŠ é€‚å½“çš„ç±»å‹æ³¨è§£
- ç¼–å†™å•å…ƒæµ‹è¯•
- æ›´æ–°æ–‡æ¡£

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œè¯¦è§LICENSEæ–‡ä»¶ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š
- GitHub Issues: [é¡¹ç›®Issuesé¡µé¢](https://github.com/h66840/rag_project/issues)
- é‚®ç®±: [é¡¹ç›®ç»´æŠ¤è€…é‚®ç®±]

---

**äº«å—æ‚¨çš„æ™ºèƒ½å®¶å±…ç”Ÿæ´»ï¼** ğŸ¡âœ¨